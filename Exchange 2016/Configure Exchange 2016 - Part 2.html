<h1>Configuring Exchange 2016 - Part 2</h1>So this post will go into accepted domains, address policies. &nbsp;This Post is following on from Part 1 of configuration in the last post.<br><br><br><h3>Accepted Domains</h3><br>First lets look at accepted domains, for people new to Exchange this is just a list of domains your server will accept.<br>Steps to add a domain are:<br><br><ol><li>Go to Mail Flow left panel</li><li>Select accepted Domains from the top panel</li><li>Click + sign to bring up the new window</li><li>Enter the name for the domain and the domain</li><li>Select correct domain type, for this example we want our server to accepted any emails for uses in our active directory</li><li>Then click Save</li></ol><br><img alt="Thumb screen shot 2016 07 19 at 120801" src="/uploads/bootsy/image/38/large_Screen_Shot_2016-07-19_at_12.08.01.png"><br><br><br>Now we have the domains that we accept we can setup Address Policy.<br><br><h3>Address Policy</h3>Address policies allow you to give different address formats to different group of users. &nbsp;Now in Exchange 2016 I found that this doesn't work in the GUI. &nbsp;So I will show how in the GUI and where it fails, then I will show you the powershell command.<br><br>So lets do GUI way first:<br><ol><li>Select Mail flow from left panel</li><li>Select Email address Policies from the top panel</li><li>Click the Plus sign</li><li>Enter a name for the policy</li><li>Select "Only the following recipients types:" and tick "Users with exchange mailboxes" - (this is just this example, you could select different)</li><li>Click the Plus sign</li></ol><img alt="Thumb address pol 1" src="/uploads/bootsy/image/46/large_Address_Pol_1.png"><br><br>In the next window is where the policy is actually created.<br><ol><li>First click more options</li><li>Tick "Enter a Custom Address type"</li><li>Enter "SMTP"</li><li>Enter the address parameters - not in this part you can use variables but I won't go into that.</li><li>Click save</li></ol><img alt="Thumb address pol 2" src="/uploads/bootsy/image/47/large_address_pol_2.png"><br><img alt="Thumb address pol 3" src="/uploads/bootsy/image/48/large_address_pol_3.png">&nbsp;<br><br>Now this is where the problem happens. &nbsp;Now I haven't really looked into this and there could be a reason its happening. &nbsp;But I will show you the powershell to get around this. &nbsp;So once you have clicked save you will notice that your policy is showing, but there is now address format, so now when you try to save this it fails.<br><br><img alt="Thumb screen shot 2016 07 20 at 111849" src="/uploads/bootsy/image/42/large_Screen_Shot_2016-07-20_at_11.18.49.png"><br><br>It should look something like this, so if your install looks like this then you won't need the powershell command.<br><br><img alt="Thumb screen shot 2016 07 20 at 112513" src="/uploads/bootsy/image/43/large_Screen_Shot_2016-07-20_at_11.25.13.png"><br>Now for the powershell way:<br>From the Exchange console all you need is the following command:<br><pre class="language-powershell"><code>New-EmailAddressPolicy -Name "pdavies" -IncludedRecipients MailBoxUsers -EnabledPrimarySMTPAddressTemplate "SMTP:@phildavies.com.au"</code></pre><br><br><img alt="Thumb screen shot 2016 07 20 at 112757" src="/uploads/bootsy/image/49/large_Screen_Shot_2016-07-20_at_11.27.57.png"><br><br>Now you will see the new address Policy<br><br><img alt="Thumb screen shot 2016 07 23 at 001542" src="/uploads/bootsy/image/50/large_Screen_Shot_2016-07-23_at_00.15.42.png"><br>